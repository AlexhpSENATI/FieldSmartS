<!-- import { useEffect } from "react";
import {
  Home,
  BarChart2,
  Sliders,
  Settings,
  FileText,
  ChevronRight,
  Search,
  Bell,
} from "lucide-react";

export default function Dashboard() {
  useEffect(() => {
    const currentPath = window.location.pathname.split("/").pop();
    const links = document.querySelectorAll("aside nav a");

    links.forEach((link) => {
      const linkPath = link.getAttribute("href");

      if (linkPath === currentPath) {
        link.classList.remove("text-gray-200", "hover:bg-white/5");
        link.classList.add("bg-white", "text-gray-900", "font-medium");
      } else {
        link.classList.remove("bg-white", "text-gray-900", "font-medium");
        link.classList.add("text-gray-200", "hover:bg-white/5");
      }
    });
  }, []);

  return (
    <div className="bg-[#e9e9e9] h-screen p-3">
      <div className="h-full grid grid-cols-[260px_1fr] gap-3">
        {/* Sidebar */}
        <aside className="bg-[#0f1116] text-white rounded-2xl flex flex-col shadow-lg overflow-hidden">
          {/* Logo */}
          <div className="flex flex-col items-center py-6 border-b border-white/10">
            <img
              src="https://via.placeholder.com/80"
              alt="Logo"
              className="w-20 h-20 rounded-full mb-2 object-cover"
            />
            <h1 className="text-base font-bold tracking-[0.2em]">FIELDSMART</h1>
          </div>

          {/* Men√∫ */}
          <nav className="mt-4 flex-1 space-y-1 px-3">
            <a href="dash.html" className="flex items-center gap-3 px-4 py-2 rounded-lg">
              <Home className="w-5 h-5" />
              <span>Dashboard</span>
            </a>
            <a href="1.html" className="flex items-center gap-3 px-4 py-2 rounded-lg">
              <BarChart2 className="w-5 h-5" />
              <span>Estad√≠sticas</span>
            </a>
            <a href="2.html" className="flex items-center gap-3 px-4 py-2 rounded-lg">
              <Sliders className="w-5 h-5" />
              <span>Control</span>
            </a>
            <a href="configuracion.html" className="flex items-center gap-3 px-4 py-2 rounded-lg">
              <Settings className="w-5 h-5" />
              <span>Configuraci√≥n</span>
            </a>
            <a href="logs.html" className="flex items-center gap-3 px-4 py-2 rounded-lg">
              <FileText className="w-5 h-5" />
              <span>Logs</span>
            </a>
          </nav>

          {/* Bot√≥n cerrar */}
          <div className="p-4">
            <button className="w-full flex items-center justify-between bg-white text-gray-900 py-2 px-3 rounded-lg font-medium">
              <span>Cerrar</span>
              <span className="w-6 h-6 rounded-full grid place-items-center border border-sky-600 text-sky-600">
                <ChevronRight className="w-4 h-4" />
              </span>
            </button>
          </div>
        </aside>

        {/* Columna derecha */}
        <div className="flex flex-col min-h-0">
          {/* Topbar */}
          <header className="bg-[#0f1116] rounded-2xl h-14 flex items-center gap-3 px-4 shadow-md shrink-0">
            {/* Buscador */}
            <div className="relative flex-1">
              <Search className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500" />
              <input
                type="text"
                placeholder="Buscar"
                className="w-full h-10 rounded-full pl-12 pr-4 outline-none text-gray-900"
              />
            </div>

            {/* Iconos + avatar */}
            <button className="w-9 h-9 rounded-full bg-white grid place-items-center shadow">
              <Bell className="w-5 h-5 text-gray-700" />
            </button>
            <button className="w-9 h-9 rounded-full bg-white grid place-items-center shadow">
              <Settings className="w-5 h-5 text-gray-700" />
            </button>
            <img
              src="https://via.placeholder.com/40"
              alt="Perfil"
              className="w-9 h-9 rounded-full object-cover ring-2 ring-white/30"
            />
          </header>

          {/* Contenido */}
          <section className="flex-1 mt-3 rounded-2xl bg-[#dfe0e1] p-6 shadow-inner overflow-y-auto no-scrollbar">
            <h1
              className="text-2xl font-black uppercase tracking-[0.15em] text-[#1d2a38]"
              style={{ fontFamily: "Georgia, 'Times New Roman', serif" }}
            >
              PANEL DE CONTROL
            </h1>

            <div className="mt-4 space-y-4">
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 1</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 2</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 3</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 4</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 5</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 6</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 7</div>
              <div className="bg-gray-300 p-6 rounded-xl">Bloque 8</div>
            </div>
          </section>
        </div>
      </div>
    </div>
  );
} -->


<!-- // src/notificaciones.js
import { db } from "./firebase";
import { ref, onChildAdded, get, child } from "firebase/database";

// ‚ö†Ô∏è Reemplaza con tu token y tu chat ID
const TELEGRAM_TOKEN = "8107271422:AAHnnAGEYp_6CUG5bvaoT8cJebYuzAL6FAI";
const CHAT_ID = "6588607200";

let ultimaVez = 0;
let ultimoEstado = null;
// ======================== ENVIAR MENSAJE A TELEGRAM ========================
function enviarTelegram(mensaje, chatId = CHAT_ID) {
    const ahora = Date.now();
    if (ahora - ultimaVez < 1000) return; // Evitar spam (1 seg m√≠nimo)
    ultimaVez = ahora;

    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;

    fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            chat_id: chatId,
            text: mensaje,
        }),
    })
        .then((res) => res.json())
        .then((data) => console.log("Mensaje enviado a Telegram:", data))
        .catch((err) => console.error("Error enviando a Telegram:", err));
}
// ======================== MOSTRAR NOTIFICACI√ìN EN EL NAVEGADOR ========================
function mostrarNotificacion(mensaje) {
    if (Notification.permission === "granted") {
        new Notification("Notificaci√≥n de Riego", {
            body: mensaje,
            icon: "/icons/water.png",
        });
    } else if (Notification.permission !== "denied") {
        Notification.requestPermission().then((permiso) => {
            if (permiso === "granted") {
                new Notification("Notificaci√≥n de Riego", {
                    body: mensaje,
                    icon: "/icons/water.png",
                });
            }
        });
    }
}
// ======================== OBTENER DATOS ACTUALES ========================
async function obtenerDatosActuales() {
    try {
        const snapshot = await get(child(ref(db), "datos"));
        if (snapshot.exists()) {
            const datos = snapshot.val();
            const ultimaClave = Object.keys(datos).pop();
            const registro = datos[ultimaClave];

            return `üìä Datos actuales:
üå°Ô∏è Temp: ${registro.temperatura}¬∞C
üíß Humedad: ${registro.humedad}%
üå´Ô∏è Humedad Ambiental: ${registro.humedadAmbiental}%
üö∞ Bomba: ${registro.bomba ? "ENCENDIDA" : "APAGADA"}`;
        } else {
            return "‚ö†Ô∏è No hay datos disponibles en Firebase.";
        }
    } catch (err) {
        console.error("Error obteniendo datos:", err);
        return "‚ö†Ô∏è Error al consultar Firebase.";
    }
}

// ======================== ESCUCHAR MENSAJES DE TELEGRAM ========================
let ultimoUpdateId = 0;
async function escucharMensajes() {
    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/getUpdates?offset=${ultimoUpdateId + 1}&timeout=30`;

    try {
        const res = await fetch(url);
        const data = await res.json();

        if (data.result && data.result.length > 0) {
            for (const update of data.result) {
                ultimoUpdateId = update.update_id;
                const mensajeTexto = update.message?.text?.toUpperCase();
                const chatId = update.message?.chat.id;

                if (mensajeTexto === "MUESTRAME LOS DATOS ACTUAL") {
                    const respuesta = await obtenerDatosActuales();
                    enviarTelegram(respuesta, chatId);
                }
            }
        }
    } catch (err) {
        console.error("Error escuchando mensajes:", err);
    }

    // Llamar otra vez (loop infinito)
    escucharMensajes();
}

// async function escucharMensajes() {
//     const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/getUpdates?offset=${ultimoUpdateId + 1}`;

//     try {
//         const res = await fetch(url);
//         const data = await res.json();

//         if (!data.result || data.result.length === 0) return;

//         for (const update of data.result) {
//             ultimoUpdateId = update.update_id;
//             const mensajeTexto = update.message?.text?.toUpperCase();
//             const chatId = update.message?.chat.id;

//             console.log("Mensaje recibido en Telegram:", mensajeTexto);

//             if (mensajeTexto === "MUESTRAME LOS DATOS ACTUAL") {
//                 const respuesta = await obtenerDatosActuales();
//                 enviarTelegram(respuesta, chatId);
//             }
//         }
//     } catch (err) {
//         console.error("Error escuchando mensajes:", err);
//     }
// }

// ========================
//  MONITOREO PRINCIPAL
// ========================

//======================== INICIAR MONITOREO ========================
export function iniciarMonitoreo() {
    const refDatos = ref(db, "datos");

    onChildAdded(refDatos, (snapshot) => {
        const registro = snapshot.val();
        if (!registro) return;

        console.log("Nuevo registro desde Firebase:", registro);

        if (registro.bomba !== ultimoEstado) {
            ultimoEstado = registro.bomba;

            const mensaje = registro.bomba
                ? `üö∞ La bomba se ha ENCENDIDO
üå°Ô∏è Temp: ${registro.temperatura}¬∞C
üíß Humedad: ${registro.humedad}%
üå´Ô∏è Humedad Ambiental: ${registro.humedadAmbiental}%`
                : `üíß La bomba se ha APAGADO
üå°Ô∏è Temp: ${registro.temperatura}¬∞C
üíß Humedad: ${registro.humedad}%
üå´Ô∏è Humedad Ambiental: ${registro.humedadAmbiental}%`;;

            mostrarNotificacion(mensaje);
            enviarTelegram(mensaje);
        }
    });

    setInterval(escucharMensajes, 5000);
} -->
